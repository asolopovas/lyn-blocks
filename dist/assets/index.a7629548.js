import{__ as c}from"@wordpress/i18n";import{createBlock as B,store as P,createBlocksFromInnerBlocksTemplate as b,registerBlockType as D}from"@wordpress/blocks";import l from"react";import{c as z}from"./index.21ce5c8d.js";import{mapValues as R,merge as F,times as H,get as M}from"lodash";import{PanelBody as G,RangeControl as S,FormTokenField as O,Notice as Z,ToggleControl as q,SVG as k,Path as f}from"@wordpress/components";import{store as h,useBlockProps as E,useInnerBlocksProps as $,BlockControls as L,BlockVerticalAlignmentToolbar as N,InspectorControls as j,__experimentalBlockVariationPicker as K}from"@wordpress/block-editor";import{withDispatch as U,useSelect as x,useDispatch as X}from"@wordpress/data";import{createElement as T}from"@wordpress/element";import{SVG as J,Path as Q}from"@wordpress/primitives";const Y=T(J,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},T(Q,{d:"M19 6H6c-1.1 0-2 .9-2 2v9c0 1.1.9 2 2 2h13c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm-4.1 1.5v10H10v-10h4.9zM5.5 17V8c0-.3.2-.5.5-.5h2.5v10H6c-.3 0-.5-.2-.5-.5zm14 0c0 .3-.2.5-.5.5h-2.6v-10H19c.3 0 .5.2.5.5v9z"})),ee=Y;const V=e=>{const t=parseFloat(e);return Number.isFinite(t)?parseFloat(t.toFixed(2)):void 0};function A(e,t){const{width:n=100/t}=e.attributes;return V(n)}function te(e,t=e.length){return e.reduce((n,o)=>n+A(o,t),0)}function ne(e,t=e.length){return e.reduce((n,o)=>{const i=A(o,t);return Object.assign(n,{[o.clientId]:i})},{})}function _(e,t,n=e.length){const o=te(e,n);return R(ne(e,n),i=>{const s=t*i/o;return V(s)})}function oe(e){return e.every(t=>{var o;const n=t.attributes.width;return Number.isFinite((o=n==null?void 0:n.endsWith)!=null&&o.call(n,"%")?parseFloat(n):n)})}function I(e,t){return e.map(n=>F({},n,{attributes:{width:`${t[n.clientId]}%`}}))}const le=["lyn/column"],ie=["grid-cols-1","grid-cols-2","grid-cols-3","grid-cols-4","grid-cols-5","grid-cols-6"];function re({attributes:e,setAttributes:t,updateAlignment:n,updateColumns:o,updateClasses:i,updateGap:s,clientId:d}){const{isStackedOnMobile:m,verticalAlignment:u,gridGap:r,gridCols:w,customClasses:p}=e,{count:a}=x(g=>({count:g(h).getBlockCount(d)}),[d]);t({gridCols:a}),console.log({customClasses:p});const v=z({grid:!0,[`grid-cols-${a}`]:a,[`gap-${r}`]:r}),y=E({className:v}),C=$(y,{allowedBlocks:le,orientation:"horizontal",renderAppender:!1});return l.createElement(l.Fragment,null,l.createElement(L,null,l.createElement(N,{onChange:n,value:u})),l.createElement(j,null,l.createElement(G,null,l.createElement(S,{label:c("Grid Gap"),value:r,onChange:g=>s(g),default:2,min:1,max:Math.max(96,a)}),l.createElement(O,{value:p,suggestions:ie,onChange:g=>i(g)}),l.createElement(S,{label:c("Columns"),value:a,onChange:g=>o(a,g),min:1,max:Math.max(6,a)}),a>6&&l.createElement(Z,{status:"warning",isDismissible:!1},c("This column count exceeds the recommended amount and may cause visual breakage.")),l.createElement(q,{label:c("Stack on mobile"),checked:m,onChange:()=>t({isStackedOnMobile:!m})}))),l.createElement("div",{...C}))}const se=U((e,t,n)=>({updateClasses(o){const{clientId:i,setAttributes:s}=t;e(h),n.select(h),s({customClasses:o})},updateGap(o){const{clientId:i,setAttributes:s}=t;e(h),n.select(h),s({gridGap:o})},updateAlignment(o){const{clientId:i,setAttributes:s}=t,{updateBlockAttributes:d}=e(h),{getBlockOrder:m}=n.select(h);s({verticalAlignment:o}),m(i).forEach(r=>{d(r,{verticalAlignment:o})})},updateColumns(o,i){const{clientId:s,setAttributes:d}=t,{replaceInnerBlocks:m}=e(h),{getBlocks:u}=n.select(h);let r=u(s);const w=oe(r);d({columnCount:i});const p=i>o;if(p&&w){const a=V(100/i),v=_(r,100-a);r=[...I(r,v),...H(i-o,()=>B("core/column",{width:`${a}%`}))]}else if(p)r=[...r,...H(i-o,()=>B("core/column"))];else if(r=r.slice(0,-(o-i)),w){const a=_(r,100);r=I(r,a)}m(s,r)}}))(re);function ce({clientId:e,name:t,setAttributes:n}){const{blockType:o,defaultVariation:i,variations:s}=x(u=>{const{getBlockVariations:r,getBlockType:w,getDefaultBlockVariation:p}=u(P);return{blockType:w(t),defaultVariation:p(t,"block"),variations:r(t,"block")}},[t]),{replaceInnerBlocks:d}=X(h),m=E();return l.createElement("div",{...m},l.createElement(K,{icon:M(o,["icon","src"]),label:M(o,["title"]),variations:s,onSelect:(u=i)=>{u.attributes&&n(u.attributes),u.innerBlocks&&d(e,b(u.innerBlocks),!0)},allowSkip:!0}))}const ae=e=>{const{clientId:t}=e,o=x(i=>i(h).getBlocks(t).length>0,[t])?se:ce;return l.createElement(o,{...e})},me="https://schemas.wp.org/trunk/block.json",ue=2,de="lyn/columns",he="Lyntoch Columns",pe="design",ge="Columns with Tailwind Styles",we="default",ke={customClasses:{type:"array"},gridCols:{type:"number"},gridGap:{type:"number",default:2},verticalAlignment:{type:"string"},isStackedOnMobile:{type:"boolean",default:!0}},fe={anchor:!0,align:["wide","full"],html:!1,color:{gradients:!0,link:!0,__experimentalDefaultControls:{background:!0,text:!0}},spacing:{blockGap:{__experimentalDefault:"2em"},margin:["top","bottom"],padding:!0,__experimentalDefaultControls:{padding:!0}},__experimentalLayout:{allowSwitching:!1,allowInheriting:!1,allowEditing:!1,default:{type:"flex",flexWrap:"nowrap"}},__experimentalBorder:{color:!0,radius:!0,style:!0,width:!0,__experimentalDefaultControls:{color:!0,radius:!0,style:!0,width:!0}}},ve="file:./index.js",ye="file:./index.css",Ce="file:./style-index.css",Be={$schema:me,apiVersion:ue,name:de,title:he,category:pe,description:ge,textdomain:we,attributes:ke,supports:fe,editorScript:ve,editorStyle:ye,style:Ce};function be(e){const{isStackedOnMobile:t,verticalAlignment:n,gridCols:o,gridGap:i}=e.attributes,s=z({grid:!0,[`are-vertically-aligned-${n}`]:n,["is-not-stacked-on-mobile"]:!t,[`gap-${i}`]:i,[`grid-cols-${o}`]:o}),d=E.save({className:s}),m=$.save(d);return l.createElement("div",{...m})}const Ee=[{name:"one-column-full",title:c("100"),description:c("One column"),icon:l.createElement(k,{width:"48",height:"48",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg"},l.createElement(f,{fillRule:"evenodd",clipRule:"evenodd",d:"m39.0625 14h-30.0625v20.0938h30.0625zm-30.0625-2c-1.10457 0-2 .8954-2 2v20.0938c0 1.1045.89543 2 2 2h30.0625c1.1046 0 2-.8955 2-2v-20.0938c0-1.1046-.8954-2-2-2z"})),innerBlocks:[["lyn/column"]],scope:["block"]},{name:"two-columns-equal",title:c("50 / 50"),description:c("Two columns; equal split"),icon:l.createElement(k,{width:"48",height:"48",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg"},l.createElement(f,{fillRule:"evenodd",clipRule:"evenodd",d:"M39 12C40.1046 12 41 12.8954 41 14V34C41 35.1046 40.1046 36 39 36H9C7.89543 36 7 35.1046 7 34V14C7 12.8954 7.89543 12 9 12H39ZM39 34V14H25V34H39ZM23 34H9V14H23V34Z"})),isDefault:!0,innerBlocks:[["lyn/column"],["lyn/column"]],scope:["block"]},{name:"two-columns-one-third-two-thirds",title:c("33 / 66"),description:c("Two columns; one-third, two-thirds split"),icon:l.createElement(k,{width:"48",height:"48",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg"},l.createElement(f,{fillRule:"evenodd",clipRule:"evenodd",d:"M39 12C40.1046 12 41 12.8954 41 14V34C41 35.1046 40.1046 36 39 36H9C7.89543 36 7 35.1046 7 34V14C7 12.8954 7.89543 12 9 12H39ZM39 34V14H20V34H39ZM18 34H9V14H18V34Z"})),innerBlocks:[["lyn/column",{width:"33.33%"}],["lyn/column",{width:"66.66%"}]],scope:["block"]},{name:"two-columns-two-thirds-one-third",title:c("66 / 33"),description:c("Two columns; two-thirds, one-third split"),icon:l.createElement(k,{width:"48",height:"48",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg"},l.createElement(f,{fillRule:"evenodd",clipRule:"evenodd",d:"M39 12C40.1046 12 41 12.8954 41 14V34C41 35.1046 40.1046 36 39 36H9C7.89543 36 7 35.1046 7 34V14C7 12.8954 7.89543 12 9 12H39ZM39 34V14H30V34H39ZM28 34H9V14H28V34Z"})),innerBlocks:[["lyn/column",{width:"66.66%"}],["lyn/column",{width:"33.33%"}]],scope:["block"]},{name:"three-columns-equal",title:c("33 / 33 / 33"),description:c("Three columns; equal split"),icon:l.createElement(k,{width:"48",height:"48",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg"},l.createElement(f,{fillRule:"evenodd",d:"M41 14a2 2 0 0 0-2-2H9a2 2 0 0 0-2 2v20a2 2 0 0 0 2 2h30a2 2 0 0 0 2-2V14zM28.5 34h-9V14h9v20zm2 0V14H39v20h-8.5zm-13 0H9V14h8.5v20z"})),innerBlocks:[["lyn/column"],["lyn/column"],["lyn/column"]],scope:["block"]},{name:"three-columns-wider-center",title:c("25 / 50 / 25"),description:c("Three columns; wide center column"),icon:l.createElement(k,{width:"48",height:"48",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg"},l.createElement(f,{fillRule:"evenodd",d:"M41 14a2 2 0 0 0-2-2H9a2 2 0 0 0-2 2v20a2 2 0 0 0 2 2h30a2 2 0 0 0 2-2V14zM31 34H17V14h14v20zm2 0V14h6v20h-6zm-18 0H9V14h6v20z"})),innerBlocks:[["lyn/column",{width:"25%"}],["lyn/column",{width:"50%"}],["lyn/column",{width:"25%"}]],scope:["block"]}],xe=6,Ve={from:[{type:"block",isMultiBlock:!0,blocks:["*"],__experimentalConvert:e=>{const t=+(100/e.length).toFixed(2),n=e.map(({name:o,attributes:i,innerBlocks:s})=>["lyn/column",{width:`${t}%`},[[o,{...i},s]]]);return B("lyn/columns",{},b(n))},isMatch:({length:e})=>e&&e<=xe},{type:"block",blocks:["core/media-text"],priority:1,transform:(e,t)=>{const{align:n,backgroundColor:o,textColor:i,style:s,mediaAlt:d,mediaId:m,mediaPosition:u,mediaSizeSlug:r,mediaType:w,mediaUrl:p,mediaWidth:a,verticalAlignment:v}=e;let y;if(w==="image"||!w){const g={id:m,alt:d,url:p,sizeSlug:r},W={href:e.href,linkClass:e.linkClass,linkDestination:e.linkDestination,linkTarget:e.linkTarget,rel:e.rel};y=["core/image",{...g,...W}]}else y=["core/video",{id:m,src:p}];const C=[["lyn/column",{width:`${a}%`},[y]],["lyn/column",{width:`${100-a}%`},t]];return u==="right"&&C.reverse(),B("lyn/columns",{align:n,backgroundColor:o,textColor:i,style:s,verticalAlignment:v},b(C))}}]};wp.hooks.removeFilter("editor.BlockListBlock","core/editor/layout/with-layout-styles");const{name:He}=Be;D(He,{icon:ee,variations:Ee,example:{viewportWidth:600,innerBlocks:[{name:"lyn/column",innerBlocks:[{name:"core/paragraph",attributes:{content:c("Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent et eros eu felis.")}},{name:"core/image",attributes:{url:"https://s.w.org/images/core/5.3/Windbuchencom.jpg"}},{name:"core/paragraph",attributes:{content:c("Suspendisse commodo neque lacus, a dictum orci interdum et.")}}]},{name:"lyn/column",innerBlocks:[{name:"core/paragraph",attributes:{content:c("Etiam et egestas lorem. Vivamus sagittis sit amet dolor quis lobortis. Integer sed fermentum arcu, id vulputate lacus. Etiam fermentum sem eu quam hendrerit.")}},{name:"core/paragraph",attributes:{content:c("Nam risus massa, ullamcorper consectetur eros fermentum, porta aliquet ligula. Sed vel mauris nec enim.")}}]}]},edit:ae,save:be,transforms:Ve});
